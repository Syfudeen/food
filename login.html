<!DOCTYPE html>
<html>
<head>
	<title>Login Page</title>
	<link rel="stylesheet" href="style.css">
	<link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
	<script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyD5KKgtq-2Qd__pn_w6zWUPJpUwtaTw4Fg",
            authDomain: "restaurant-app-fed29.firebaseapp.com",
            projectId: "restaurant-app-fed29",
            storageBucket: "restaurant-app-fed29.firebasestorage.app",
            messagingSenderId: "613195852332",
            appId: "1:613195852332:web:aa3a76d763d87cc2a07f89"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        window.loginUser = function(event) {
            event.preventDefault();
            console.log('Login function called');

            const email = document.querySelector('input[name="email"]').value;
            const password = document.querySelector('input[name="password"]').value;
            
            console.log('Email:', email);
            console.log('Firebase auth available:', typeof signInWithEmailAndPassword);

            signInWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    const user = userCredential.user;
                    console.log('Login successful:', user);
                    
                    // Store user in localStorage for session management
                    localStorage.setItem('currentUser', JSON.stringify({
                        name: user.displayName || email.split('@')[0],
                        email: user.email,
                        uid: user.uid
                    }));
                    
                    alert('Login successful!');
                    window.location.href = 'index.html';
                })
                .catch((error) => {
                    console.error('Login error:', error);
                    alert('Login failed: ' + error.message);
                });
        }
    </script>
	<style>
		body{
			padding-top:100px;
		}
		.forgot-password{
			text-align:center;
			margin-top:15px;
		}
		.forgot-password a{
			color:#ff4500;
			text-decoration:none;
			font-size:14px;
		}
		.forgot-password a:hover{
			text-decoration:underline;
		}
		.message{
			text-align:center;
			padding:10px;
			margin:10px 0;
			border-radius:5px;
		}
		.success{
			background-color:#d4edda;
			color:#155724;
			border:1px solid #c3e6cb;
		}
		.error{
			background-color:#f8d7da;
			color:#721c24;
			border:1px solid #f5c6cb;
		}
	</style>
</head>
<body>

<div class="form">
	<h3 class="form-title">LOGIN</h3>
	<div id="message-container"></div>

	<form class="form-body" onsubmit="loginUser(event)">
		<label>Email:</label>
		<input type="email" name="email" id="email" required>

		<label>Password:</label>
		<input type="password" name="password" id="password" required>

		<button type="submit">Login</button>
	</form>

	<div class="forgot-password">
		<a href="#" onclick="showForgotPassword(event)">Forgot Password?</a>
	</div>

	<div id="forgot-form" style="display:none;margin-top:20px;">
		<h4>Reset Password</h4>
		<form onsubmit="handleForgotPassword(event)">
			<label>Email:</label>
			<input type="email" id="forgot-email" required>
			<button type="submit">Send Reset Link</button>
		</form>
	</div>
</div>

<script>
function showForgotPassword(e){
	e.preventDefault();
	document.getElementById("forgot-form").style.display="block";
}

function showMessage(message,type){
	const container=document.getElementById("message-container");
	container.innerHTML=`<div class="message ${type}">${message}</div>`;
	setTimeout(()=>{container.innerHTML=""},5000);
}

function handleForgotPassword(e){
	e.preventDefault();
	const email=document.getElementById('forgot-email').value;
	
	// Simple alert for now - Firebase password reset can be added later
	alert('Password reset functionality will be available soon. Please contact support for password reset.');
}
</script>

</body>
</html>
